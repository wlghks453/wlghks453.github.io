---
layout: default
title: λ²ν¬ μμ •
parent: SPRING DATA JPA
grand_parent: μ¤ν”„λ§
nav_order: 4
---

{: .no_toc }
 
{: .no_toc .text-delta }

1. TOC
{:toc}

---

# π”„ λ²ν¬ μμ • (Bulk Update & Delete)

λ°μ΄ν„°λ² μ΄μ¤μ λ€λ‰μ λ°μ΄ν„°λ¥Ό ν¨μ¨μ μΌλ΅ μμ •ν•κ±°λ‚ μ‚­μ ν•  λ•λ” **λ²ν¬ μ—°μ‚°(Bulk Operation)**μ΄ ν•„μ”ν•©λ‹λ‹¤. Spring Data JPAμ—μ„λ” **@Modifying** μ–΄λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•μ—¬ `UPDATE`, `DELETE`μ™€ κ°™μ€ λ²ν¬ μ—°μ‚°μ„ μ²λ¦¬ν•  μ μμµλ‹λ‹¤. μ΄λ¬ν• λ²ν¬ μ—°μ‚°μ€ λ°μ΄ν„°λ¥Ό λΉ λ¥΄κ² λ³€κ²½ν•  μ μμ§€λ§, λ°μ΄ν„°λ² μ΄μ¤μ™€ μμ†μ„± μ»¨ν…μ¤νΈ κ°„μ μƒνƒλ¥Ό λ™κΈ°ν™”ν•λ” λ° μ£Όμκ°€ ν•„μ”ν•©λ‹λ‹¤.

## @Modifying μ–΄λ…Έν…μ΄μ…

Spring Data JPAμ—μ„ `@Query`μ™€ ν•¨κ» **λ²ν¬ μμ •**μ„ μν–‰ν•  λ•λ” **@Modifying** μ–΄λ…Έν…μ΄μ…μ„ μ¶”κ°€ν•΄μ•Ό ν•©λ‹λ‹¤. `@Modifying` μ–΄λ…Έν…μ΄μ…μ€ λ°μ΄ν„°λ² μ΄μ¤μ λ°μ΄ν„°λ¥Ό μμ •ν•κ±°λ‚ μ‚­μ ν•λ” μΏΌλ¦¬μ„μ„ Springμ—κ² μ•λ ¤μ£Όλ” μ—­ν• μ„ ν•©λ‹λ‹¤.

### @Modifying μ–΄λ…Έν…μ΄μ… μ†μ„±

`@Modifying` μ–΄λ…Έν…μ΄μ…μ€ λ‡ κ°€μ§€ μ¤‘μ”ν• μ†μ„±μ„ μ κ³µν•©λ‹λ‹¤. μ΄ μ†μ„±λ“¤μ„ μ‚¬μ©ν•μ—¬ λ²ν¬ μ—°μ‚°μ λ™μ‘μ„ μ μ–΄ν•  μ μμµλ‹λ‹¤.

1. **clearAutomatically**: (κΈ°λ³Έκ°’: `false`)
    - λ²ν¬ μ—°μ‚° ν›„ **μλ™μΌλ΅ μμ†μ„± μ»¨ν…μ¤νΈ(Persistence Context)λ¥Ό μ΄κΈ°ν™”**ν• μ§€ μ—¬λ¶€λ¥Ό κ²°μ •ν•©λ‹λ‹¤.
    - `true`λ΅ μ„¤μ •ν•λ©΄, μΏΌλ¦¬ μ‹¤ν–‰ ν›„ μμ†μ„± μ»¨ν…μ¤νΈκ°€ λΉ„μ›μ§€λ©°, λ°μ΄ν„°λ² μ΄μ¤μ μµμ‹  μƒνƒκ°€ μ μ§€λ©λ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ λ²ν¬ μ—°μ‚° ν›„ λ°μ΄ν„° μΌκ΄€μ„±μ„ μ μ§€ν•  μ μμµλ‹λ‹¤.

2. **flushAutomatically**: (κΈ°λ³Έκ°’: `false`)
    - λ²ν¬ μ—°μ‚° μ‹¤ν–‰ μ „μ— **μλ™μΌλ΅ μμ†μ„± μ»¨ν…μ¤νΈλ¥Ό ν”λ¬μ‹(Flush)** ν• μ§€ μ—¬λ¶€λ¥Ό κ²°μ •ν•©λ‹λ‹¤.
    - `true`λ΅ μ„¤μ •ν•λ©΄, μΏΌλ¦¬ μ‹¤ν–‰ μ „μ— λ³€κ²½λ μ—”ν‹°ν‹°λ“¤μ΄ λ°μ΄ν„°λ² μ΄μ¤μ— λ°μλ©λ‹λ‹¤. μ΄λ” `clearAutomatically`μ™€ ν•¨κ» μ‚¬μ©λμ–΄ λ²ν¬ μ—°μ‚° μ „ν›„λ΅ λ°μ΄ν„°λ² μ΄μ¤μ μΌκ΄€μ„±μ„ μ μ§€ν•  μ μμµλ‹λ‹¤.
    - Hibernateμ—λ” FlushModeType enum class κ°€ μ΅΄μ¬ν•λ©°, κ·Έ κ°’μΌλ΅λ” AUTOμ™€ COMMITμ΄ μμµλ‹λ‹¤. Default κ°’μ€ AUTOμΈλ° AUTOκ°€ ν•΄λ‹Ή κ°’μ„ FALSEλ΅ ν•΄λ„ μλ™μΌλ΅ FLUSHλ¥Ό λ°μƒμ‹ν‚µλ‹λ‹¤.
    - 
### μμ‹: λ²ν¬ μ—…λ°μ΄νΈ

μ•„λλ” `User` μ—”ν‹°ν‹°μ—μ„ νΉμ • μ΅°κ±΄μ— λ§λ” μ‚¬μ©μλ“¤μ μ΄λ©”μΌμ„ μΌκ΄„μ μΌλ΅ μ—…λ°μ΄νΈν•λ” JPQL μΏΌλ¦¬ μμ‹μ…λ‹λ‹¤.

```java
@Modifying
@Query("UPDATE User u SET u.email = :email WHERE u.status = :status")
int updateEmailByStatus(@Param("email") String email, @Param("status") String status);
```

## λ²ν¬ μ—°μ‚° μ‚¬μ© μ‹ μ£Όμμ‚¬ν•­

λ²ν¬ μ—°μ‚°μ€ λ°μ΄ν„°λ² μ΄μ¤μ—μ„ μ§μ ‘ μν–‰λκΈ° λ•λ¬Έμ— μμ†μ„± μ»¨ν…μ¤νΈ(Persistence Context)μ™€ λ™κΈ°ν™”λμ§€ μ•μ„ μ μμµλ‹λ‹¤. λ”°λΌμ„ λ²ν¬ μ—°μ‚° ν›„μ—λ” μμ†μ„± μ»¨ν…μ¤νΈλ¥Ό λΉ„μ°κ±°λ‚, ν•„μ”μ— λ”°λΌ λ‹¤μ‹ μ΅°νν•μ—¬ μµμ‹  μƒνƒλ¥Ό λ°μν•λ” κ²ƒμ΄ μΆ‹μµλ‹λ‹¤.
